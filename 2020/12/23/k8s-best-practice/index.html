<!DOCTYPE html>
<html lang="en">
    <!-- title -->




<!-- keywords -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="Akira">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="Akira">
    
    <meta name="keywords" content="hexo,hexo-theme,hexo-blog,blog,java,golang">
    
    <meta name="description" content="akira's notes.">
    <meta name="description" content="æœ¬æ–‡è®°å½•æˆ‘ä»å¤´æ­å»º k8s çš„è¿‡ç¨‹ã€‚ä½¿ç”¨çš„æœåŠ¡å™¨ä¸º bandwagon ç¾å›½æœºæˆ¿çš„åŒæ ¸ï¼Œ2G RAMï¼Œ40G ç¡¬ç›˜ç©ºé—´çš„ä¸»æœºï¼Œæ“ä½œç³»ç»Ÿä¸º ubuntu 18.04ã€‚ Install Docker &amp; Kubeadm123curl -s https:&#x2F;&#x2F;packages.cloud.google.com&#x2F;apt&#x2F;doc&#x2F;apt-key.gpg | apt-key add -apt-get u">
<meta property="og:type" content="article">
<meta property="og:title" content="k8s æœ€ä½³å®è·µï¼ˆFor me ğŸ™‚ï¼‰">
<meta property="og:url" content="https://konoakira.com/2020/12/23/k8s-best-practice/index.html">
<meta property="og:site_name" content="DYSTOPIA">
<meta property="og:description" content="æœ¬æ–‡è®°å½•æˆ‘ä»å¤´æ­å»º k8s çš„è¿‡ç¨‹ã€‚ä½¿ç”¨çš„æœåŠ¡å™¨ä¸º bandwagon ç¾å›½æœºæˆ¿çš„åŒæ ¸ï¼Œ2G RAMï¼Œ40G ç¡¬ç›˜ç©ºé—´çš„ä¸»æœºï¼Œæ“ä½œç³»ç»Ÿä¸º ubuntu 18.04ã€‚ Install Docker &amp; Kubeadm123curl -s https:&#x2F;&#x2F;packages.cloud.google.com&#x2F;apt&#x2F;doc&#x2F;apt-key.gpg | apt-key add -apt-get u">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-12-23T01:22:04.000Z">
<meta property="article:modified_time" content="2021-06-24T02:43:00.518Z">
<meta property="article:author" content="Akira">
<meta property="article:tag" content="k8s">
<meta name="twitter:card" content="summary">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    
    <title>k8s æœ€ä½³å®è·µï¼ˆFor me ğŸ™‚ï¼‰ Â· DYSTOPIA</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s infinite;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= "/css/style.css?v=20210204" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= "/css/mobile.css?v=20210204" media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js?v=20210204" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    <script src="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.3/js/all.min.js"  data-auto-replace-svg="nest" ></script>
    
        <!-- algolia -->
        <script>
            
            var hits = JSON.parse('{"per_page":10}')
            var labels = JSON.parse('{"input_placeholder":"Search for Posts","hits_empty":"We did not find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}')

            var algolia = {
                appId: '66KI0W75FJ',
                apiKey: '0ca84f70627c86b59375264768a98a0d',
                indexName: 'dystopia',
                hits: hits,
                labels: labels
            }
        </script>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- ç™¾åº¦ç»Ÿè®¡  -->
    
    <!-- è°·æ­Œç»Ÿè®¡  -->
    
<meta name="generator" content="Hexo 5.4.0"></head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- posté¡µçš„toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >DYSTOPIA</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">k8s æœ€ä½³å®è·µï¼ˆFor me ğŸ™‚ï¼‰</a>
            </div>
    </div>
    
    <a class="home-link" href=/>DYSTOPIA</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style="







height:50vh;
">
    
    <!-- ä¸»é¡µ  -->
    
    
    <!-- 404é¡µ  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(https://source.unsplash.com/random)"></div>
    <div class="site-intro-meta">
        <!-- æ ‡é¢˜  -->
        <h1 class="intro-title">
            <!-- ä¸»é¡µ  -->
            
            k8s æœ€ä½³å®è·µï¼ˆFor me ğŸ™‚ï¼‰
            <!-- 404 -->
            
        </h1>
        <!-- å‰¯æ ‡é¢˜ -->
        <p class="intro-subtitle">
            <!-- ä¸»é¡µå‰¯æ ‡é¢˜  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- æ–‡ç« é¡µmeta -->
        
            <div class="post-intros">
                <!-- æ–‡ç« é¡µæ ‡ç­¾  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "k8s">k8s</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count word-count">3.8k</span>Reading time: <span class="post-count reading-time">18 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2020/12/23</span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div>
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IEå†…æ ¸
        presto: u.indexOf('Presto') > -1, //operaå†…æ ¸
        webKit: u.indexOf('AppleWebKit') > -1, //è‹¹æœã€è°·æ­Œå†…æ ¸
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //ç«ç‹å†…æ ¸
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //æ˜¯å¦ä¸ºç§»åŠ¨ç»ˆç«¯
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //iosç»ˆç«¯
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //androidç»ˆç«¯æˆ–è€…ucæµè§ˆå™¨
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //æ˜¯å¦ä¸ºiPhoneæˆ–è€…å®‰å“QQæµè§ˆå™¨
        iPad: u.indexOf('iPad') > -1, //æ˜¯å¦ä¸ºiPad
        webApp: u.indexOf('Safari') == -1, //æ˜¯å¦ä¸ºwebåº”ç”¨ç¨‹åºï¼Œæ²¡æœ‰å¤´éƒ¨ä¸åº•éƒ¨
        weixin: u.indexOf('MicroMessenger') == -1, //æ˜¯å¦ä¸ºå¾®ä¿¡æµè§ˆå™¨
        uc: u.indexOf('UCBrowser') > -1 //æ˜¯å¦ä¸ºandroidä¸‹çš„UCæµè§ˆå™¨
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UCä¸æ”¯æŒè·¨åŸŸï¼Œæ‰€ä»¥ç›´æ¥æ˜¾ç¤º
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //æ‰€æœ‰å­—ä½“å¼€å§‹åŠ è½½
          // console.log('loading');
        },
        active: function () {  //æ‰€æœ‰å­—ä½“å·²æ¸²æŸ“
          fontLoaded();
        },
        inactive: function () { //å­—ä½“é¢„åŠ è½½å¤±è´¥ï¼Œæ— æ•ˆå­—ä½“æˆ–æµè§ˆå™¨ä¸æ”¯æŒåŠ è½½
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>æœ¬æ–‡è®°å½•æˆ‘ä»å¤´æ­å»º k8s çš„è¿‡ç¨‹ã€‚ä½¿ç”¨çš„æœåŠ¡å™¨ä¸º bandwagon ç¾å›½æœºæˆ¿çš„åŒæ ¸ï¼Œ2G RAMï¼Œ40G ç¡¬ç›˜ç©ºé—´çš„ä¸»æœºï¼Œæ“ä½œç³»ç»Ÿä¸º ubuntu 18.04ã€‚</p>
<h2 id="Install-Docker-amp-Kubeadm"><a href="#Install-Docker-amp-Kubeadm" class="headerlink" title="Install Docker &amp; Kubeadm"></a>Install Docker &amp; Kubeadm</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add -</span><br><span class="line">apt-get update</span><br><span class="line">apt-get install -y docker.io kubeadm</span><br></pre></td></tr></table></figure>

<p>å¾ˆç®€å•ï¼Œå¯èƒ½æ˜¯æˆ‘ç”¨çš„æ˜¯ç¾å›½çš„æœºæˆ¿ï¼Œæ²¡æœ‰ç³Ÿå¿ƒçš„æ¢æºæ“ä½œã€‚æˆ‘æ²¡æœ‰ç”¨ minikube é‚£ä¸€å¥—ï¼Œç›´æ¥å­¦ä¹ çš„æ˜¯ k8s å®˜ç½‘çš„ kubeadmï¼Œå¯èƒ½è¿™æ ·ä¼šæœ‰åŠ©äºæ¥ä¸‹æ¥çš„ k8s çš„å­¦ä¹ å§ã€‚</p>
<h2 id="First-k8s-Cluster-Node"><a href="#First-k8s-Cluster-Node" class="headerlink" title="First k8s Cluster Node"></a>First k8s Cluster Node</h2><p>è¿™é‡Œæˆ‘ç”¨çš„æ˜¯ yaml æ ¼å¼çš„é…ç½®æ–‡ä»¶æ¥éƒ¨ç½²çš„ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">kubeadm.k8s.io/v1beta2</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterConfiguration</span></span><br><span class="line"><span class="attr">kubernetesVersion:</span> <span class="string">v1.21.0</span></span><br><span class="line"><span class="attr">apiServer:</span></span><br><span class="line">  <span class="attr">extraArgs:</span></span><br><span class="line">    <span class="attr">runtime-config:</span> <span class="string">&quot;api/all=true&quot;</span></span><br><span class="line"><span class="attr">controllerManager:</span></span><br><span class="line">  <span class="attr">extraArgs:</span></span><br><span class="line">    <span class="attr">node-monitor-grace-period-duration:</span> <span class="string">&quot;10s&quot;</span></span><br><span class="line">    <span class="attr">horizontal-pod-autoscaler-sync-period:</span> <span class="string">&quot;10s&quot;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æˆ‘ç”¨çš„æ˜¯æœ€æ–°ç‰ˆçš„ k8sï¼Œä½¿ç”¨çš„ kubeadm ç‰ˆæœ¬æ˜¯ <code>kubeadm.k8s.io/v1beta2</code>ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»˜å‡ºäº†å¾ˆå¤§çš„ä»£ä»·ï¼Œç½‘ç»œä¸Šçš„æ•™ç¨‹å¾ˆå¤šè¿˜æ˜¯<code>kubeadm.k8s.io/v1alpha1</code>ã€‚</p>
<p>ä½¿ç”¨å‘½ä»¤<code>kubeadm init --config kubeadm.yaml</code>ï¼Œå°±å¯ä»¥å®Œæˆéƒ¨ç½²äº†ã€‚æˆ‘ä»¬å¯ä»¥çœ‹ä¸€çœ‹å®‰è£…æ—¶çš„logï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">[init] Using Kubernetes version: v1.21.0</span><br><span class="line">[preflight] Running pre-flight checks</span><br><span class="line">        [WARNING IsDockerSystemdCheck]: detected &quot;cgroupfs&quot; as the Docker cgroup driver. The recommended driver is &quot;systemd&quot;. Please follow the guide at https://kubernetes.io/docs/setup/cri/</span><br><span class="line">// èµ·é£å‰ æ‹‰å–é…ç½® k8s é›†ç¾¤éœ€è¦çš„é•œåƒ</span><br><span class="line">[preflight] Pulling images required for setting up a Kubernetes cluster</span><br><span class="line">[preflight] This might take a minute or two, depending on the speed of your internet connection</span><br><span class="line">// æˆ‘ä»¬å¯ä»¥ç”¨å‘½ä»¤ kubeadm config images pull æ¥æå‰æ‹‰å–é•œåƒ</span><br><span class="line">[preflight] You can also perform this action in beforehand using &#x27;kubeadm config images pull&#x27;</span><br><span class="line">// å¼€å§‹é…ç½®è¯ä¹¦</span><br><span class="line">[certs] Using certificateDir folder &quot;/etc/kubernetes/pki&quot;</span><br><span class="line">// ca è¯ä¹¦å’Œkey</span><br><span class="line">[certs] Generating &quot;ca&quot; certificate and key</span><br><span class="line">// api æœåŠ¡å™¨ è¯ä¹¦å’Œkey</span><br><span class="line">[certs] Generating &quot;apiserver&quot; certificate and key</span><br><span class="line">// api æœåŠ¡å™¨è¯ä¹¦ç­¾åç»™äº†è¿™äº› dns åŸŸåå’Œ ip</span><br><span class="line">[certs] apiserver serving cert is signed for DNS names [kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local lucid-gigs-2.localdomain] and IPs [10.96.0.1 23.105.209.66]</span><br><span class="line">// ç”Ÿæˆ å„ç§è¯ä¹¦å’Œkey</span><br><span class="line">[certs] Generating &quot;apiserver-kubelet-client&quot; certificate and key</span><br><span class="line">[certs] Generating &quot;front-proxy-ca&quot; certificate and key</span><br><span class="line">[certs] Generating &quot;front-proxy-client&quot; certificate and key</span><br><span class="line">[certs] Generating &quot;etcd/ca&quot; certificate and key</span><br><span class="line">[certs] Generating &quot;etcd/server&quot; certificate and key</span><br><span class="line">[certs] etcd/server serving cert is signed for DNS names [localhost lucid-gigs-2.localdomain] and IPs [23.105.209.66 127.0.0.1 ::1]</span><br><span class="line">[certs] Generating &quot;etcd/peer&quot; certificate and key</span><br><span class="line">[certs] etcd/peer serving cert is signed for DNS names [localhost lucid-gigs-2.localdomain] and IPs [23.105.209.66 127.0.0.1 ::1]</span><br><span class="line">[certs] Generating &quot;etcd/healthcheck-client&quot; certificate and key</span><br><span class="line">[certs] Generating &quot;apiserver-etcd-client&quot; certificate and key</span><br><span class="line">[certs] Generating &quot;sa&quot; key and public key</span><br><span class="line">// å†™å…¥ k8s é…ç½®</span><br><span class="line">[kubeconfig] Using kubeconfig folder &quot;/etc/kubernetes&quot;</span><br><span class="line">[kubeconfig] Writing &quot;admin.conf&quot; kubeconfig file</span><br><span class="line">[kubeconfig] Writing &quot;kubelet.conf&quot; kubeconfig file</span><br><span class="line">[kubeconfig] Writing &quot;controller-manager.conf&quot; kubeconfig file</span><br><span class="line">[kubeconfig] Writing &quot;scheduler.conf&quot; kubeconfig file</span><br><span class="line">// å‡†å¤‡å¯åŠ¨ Kubelet</span><br><span class="line">[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;</span><br><span class="line">[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;</span><br><span class="line">[kubelet-start] Starting the kubelet</span><br><span class="line">// åˆ›å»ºå„ç§pod</span><br><span class="line">[control-plane] Using manifest folder &quot;/etc/kubernetes/manifests&quot;</span><br><span class="line">[control-plane] Creating static Pod manifest for &quot;kube-apiserver&quot;</span><br><span class="line">[control-plane] Creating static Pod manifest for &quot;kube-controller-manager&quot;</span><br><span class="line">[control-plane] Creating static Pod manifest for &quot;kube-scheduler&quot;</span><br><span class="line">[etcd] Creating static Pod manifest for local etcd in &quot;/etc/kubernetes/manifests&quot;</span><br><span class="line">[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;/etc/kubernetes/manifests&quot;. This can take up to 4m0s</span><br><span class="line">// è¿˜æ£€æŸ¥äº†ä¸€éå¥åº·</span><br><span class="line">[apiclient] All control plane components are healthy after 33.023699 seconds</span><br><span class="line">// ä¿å­˜ä¸Šä¼ Kubeadmé…ç½®åˆ° å‘½åç©ºé—´ kube-system ä¸‹çš„ kubeadm-config</span><br><span class="line">[upload-config] Storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace</span><br><span class="line">[kubelet] Creating a ConfigMap &quot;kubelet-config-1.21&quot; in namespace kube-system with the configuration for the kubelets in the cluster</span><br><span class="line">// ä¸Šä¼ è¯ä¹¦</span><br><span class="line">[upload-certs] Skipping phase. Please see --upload-certs</span><br><span class="line">// æ ‡è®° control plane</span><br><span class="line">[mark-control-plane] Marking the node lucid-gigs-2.localdomain as control-plane by adding the labels: [node-role.kubernetes.io/master(deprecated) node-role.kubernetes.io/control-plane node.kubernetes.io/exclude-from-external-load-balancers]</span><br><span class="line">[mark-control-plane] Marking the node lucid-gigs-2.localdomain as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]</span><br><span class="line">[bootstrap-token] Using token: 4z7j17.6crhs6bqjcjm7uyn</span><br><span class="line">[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to get nodes</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token</span><br><span class="line">[bootstrap-token] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster</span><br><span class="line">// ä¿å­˜ cluster-info é…ç½®åˆ° kube-public å‘½åç©ºé—´ä¸‹</span><br><span class="line">[bootstrap-token] Creating the &quot;cluster-info&quot; ConfigMap in the &quot;kube-public&quot; namespace</span><br><span class="line">[kubelet-finalize] Updating &quot;/etc/kubernetes/kubelet.conf&quot; to point to a rotatable kubelet client certificate and key</span><br><span class="line">// åº”ç”¨ CoreDNS kube-proxy</span><br><span class="line">[addons] Applied essential addon: CoreDNS</span><br><span class="line">[addons] Applied essential addon: kube-proxy</span><br><span class="line"></span><br><span class="line">Your Kubernetes control-plane has initialized successfully!</span><br></pre></td></tr></table></figure>

<p>ä¸ªäººæ„Ÿè§‰æ•´ä¸ªè¿‡ç¨‹è¿˜æ˜¯ååˆ†æ¸…æ™°çš„ï¼ˆè™½ç„¶ä¸æ˜¯å¾ˆæ˜ç¡®å„ä¸ªç»„ä»¶çš„å…·ä½“èŒè´£ï¼Œä½†èƒ½å¤§æ¦‚å¯Ÿè§‰åˆ° k8s åº”è¯¥æœ‰è¿™äº›æ ¸å¿ƒåŠŸèƒ½ï¼‰ã€‚ç„¶åå¤åˆ¶é…ç½®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br><span class="line">// Alternatively, if you are the root user, you can run:</span><br><span class="line">export KUBECONFIG=/etc/kubernetes/admin.conf</span><br></pre></td></tr></table></figure>

<p>éœ€è¦è¿™äº›é…ç½®å‘½ä»¤çš„åŸå› æ˜¯ï¼šKubernetesé›†ç¾¤é»˜è®¤éœ€è¦åŠ å¯†æ–¹å¼è®¿é—®ã€‚æ‰€ä»¥ï¼Œè¿™å‡ æ¡å‘½ä»¤ï¼Œå°±æ˜¯å°†åˆšåˆšéƒ¨ç½²ç”Ÿæˆçš„Kubernetesé›†ç¾¤çš„å®‰å…¨é…ç½®æ–‡ä»¶ï¼Œä¿å­˜åˆ°å½“å‰ç”¨æˆ·çš„<code>.kube</code>ç›®å½•ä¸‹ï¼Œkubectlé»˜è®¤ä¼šä½¿ç”¨è¿™ä¸ªç›®å½•ä¸‹çš„æˆæƒä¿¡æ¯è®¿é—®Kubernetesé›†ç¾¤ã€‚å½“ç„¶ï¼Œä½œä¸ºä¸€ä¸ª root ç”¨æˆ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>export KUBECONFIG</code>ç¯å¢ƒå˜é‡å‘Šè¯‰kubectlè¿™ä¸ªå®‰å…¨é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚</p>
<p>æœ€åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubeadm join 23.105.209.66:6443 --token 4z7j17.6crhs6bqjcjm7uyn \</span><br><span class="line">        --discovery-token-ca-cert-hash sha256:3d2617928c09a3341f16f71de5b5722800c88cacbd6fdc3f4795020bb524a201</span><br></pre></td></tr></table></figure>

<p>æ¥åŠ å…¥å…¶ä»–èŠ‚ç‚¹äº†ã€‚</p>
<h2 id="Check-Node"><a href="#Check-Node" class="headerlink" title="Check Node"></a>Check Node</h2><p>ä½¿ç”¨å‘½ä»¤<code>kubectl get nodes</code>æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â¯ kubectl get nodes</span><br><span class="line">NAME                       STATUS     ROLES                  AGE   VERSION</span><br><span class="line">lucid-gigs-2.localdomain   NotReady   control-plane,master   42m   v1.21.1</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªå”¯ä¸€çš„èŠ‚ç‚¹è¿˜æœªå‡†å¤‡å°±ç»ªï¼š<code>NotReady</code>ã€‚</p>
<p>ä½¿ç”¨å‘½ä»¤<code>kubectl describe node lucid-gigs-2.localdomain</code>, å¾ˆä¸å¹¸ï¼Œæˆ‘å¿˜è®°é…ç½®å®ƒçš„åå­—äº†ï¼Œå¯¼è‡´è¿™ä¸ªåå­—è¿‡äºå†—é•¿ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">â¯ kubectl describe node lucid-gigs-2.localdomain</span><br><span class="line">Name:               lucid-gigs-2.localdomain</span><br><span class="line">Roles:              control-plane,master</span><br><span class="line">Labels:             beta.kubernetes.io/arch=amd64</span><br><span class="line">                    beta.kubernetes.io/os=linux</span><br><span class="line">                    kubernetes.io/arch=amd64</span><br><span class="line">                    kubernetes.io/hostname=lucid-gigs-2.localdomain</span><br><span class="line">                    kubernetes.io/os=linux</span><br><span class="line">                    node-role.kubernetes.io/control-plane=</span><br><span class="line">                    node-role.kubernetes.io/master=</span><br><span class="line">                    node.kubernetes.io/exclude-from-external-load-balancers=</span><br><span class="line">Annotations:        kubeadm.alpha.kubernetes.io/cri-socket: /var/run/dockershim.sock</span><br><span class="line">                    volumes.kubernetes.io/controller-managed-attach-detach: true</span><br><span class="line">CreationTimestamp:  Tue, 22 Jun 2021 21:20:38 -0400</span><br><span class="line">Taints:             node-role.kubernetes.io/master:NoSchedule</span><br><span class="line">                    node.kubernetes.io/not-ready:NoSchedule</span><br><span class="line">Unschedulable:      false</span><br><span class="line">Lease:</span><br><span class="line">  HolderIdentity:  lucid-gigs-2.localdomain</span><br><span class="line">  AcquireTime:     &lt;unset&gt;</span><br><span class="line">  RenewTime:       Tue, 22 Jun 2021 22:07:35 -0400</span><br><span class="line">Conditions:</span><br><span class="line">  Type             Status  LastHeartbeatTime                 LastTransitionTime                Reason                       Message</span><br><span class="line">  ----             ------  -----------------                 ------------------                ------                       -------</span><br><span class="line">  MemoryPressure   False   Tue, 22 Jun 2021 22:06:34 -0400   Tue, 22 Jun 2021 21:20:30 -0400   KubeletHasSufficientMemory   kubelet has sufficient memory available</span><br><span class="line">  DiskPressure     False   Tue, 22 Jun 2021 22:06:34 -0400   Tue, 22 Jun 2021 21:20:30 -0400   KubeletHasNoDiskPressure     kubelet has no disk pressure</span><br><span class="line">  PIDPressure      False   Tue, 22 Jun 2021 22:06:34 -0400   Tue, 22 Jun 2021 21:20:30 -0400   KubeletHasSufficientPID      kubelet has sufficient PID available</span><br><span class="line">  Ready            False   Tue, 22 Jun 2021 22:06:34 -0400   Tue, 22 Jun 2021 21:20:30 -0400   KubeletNotReady              container runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized</span><br><span class="line">Addresses:</span><br><span class="line">  InternalIP:  23.105.209.66</span><br><span class="line">  Hostname:    lucid-gigs-2.localdomain</span><br><span class="line">Capacity:</span><br><span class="line">  cpu:                3</span><br><span class="line">  ephemeral-storage:  40751112Ki</span><br><span class="line">  hugepages-1Gi:      0</span><br><span class="line">  hugepages-2Mi:      0</span><br><span class="line">  memory:             2057260Ki</span><br><span class="line">  pods:               110</span><br><span class="line">Allocatable:</span><br><span class="line">  cpu:                3</span><br><span class="line">  ephemeral-storage:  37556224758</span><br><span class="line">  hugepages-1Gi:      0</span><br><span class="line">  hugepages-2Mi:      0</span><br><span class="line">  memory:             1954860Ki</span><br><span class="line">  pods:               110</span><br><span class="line">System Info:</span><br><span class="line">  Machine ID:                 85065e0182c7b9ae16af18873cda9e4d</span><br><span class="line">  System UUID:                F00F9141-B635-42BE-A4C7-F42024C5C839</span><br><span class="line">  Boot ID:                    22515326-9675-4ac3-99c5-b21dd97dfda4</span><br><span class="line">  Kernel Version:             4.15.0-20-generic</span><br><span class="line">  OS Image:                   Ubuntu 18.04 LTS</span><br><span class="line">  Operating System:           linux</span><br><span class="line">  Architecture:               amd64</span><br><span class="line">  Container Runtime Version:  docker://20.10.2</span><br><span class="line">  Kubelet Version:            v1.21.1</span><br><span class="line">  Kube-Proxy Version:         v1.21.1</span><br><span class="line">Non-terminated Pods:          (4 in total)</span><br><span class="line">  Namespace                   Name                                                CPU Requests  CPU Limits  Memory Requests  Memory Limits  Age</span><br><span class="line">  ---------                   ----                                                ------------  ----------  ---------------  -------------  ---</span><br><span class="line">  kube-system                 etcd-lucid-gigs-2.localdomain                       100m (3%)     0 (0%)      100Mi (5%)       0 (0%)         46m</span><br><span class="line">  kube-system                 kube-apiserver-lucid-gigs-2.localdomain             250m (8%)     0 (0%)      0 (0%)           0 (0%)         46m</span><br><span class="line">  kube-system                 kube-controller-manager-lucid-gigs-2.localdomain    200m (6%)     0 (0%)      0 (0%)           0 (0%)         46m</span><br><span class="line">  kube-system                 kube-scheduler-lucid-gigs-2.localdomain             100m (3%)     0 (0%)      0 (0%)           0 (0%)         46m</span><br><span class="line">Allocated resources:</span><br><span class="line">  (Total limits may be over 100 percent, i.e., overcommitted.)</span><br><span class="line">  Resource           Requests    Limits</span><br><span class="line">  --------           --------    ------</span><br><span class="line">  cpu                650m (21%)  0 (0%)</span><br><span class="line">  memory             100Mi (5%)  0 (0%)</span><br><span class="line">  ephemeral-storage  100Mi (0%)  0 (0%)</span><br><span class="line">  hugepages-1Gi      0 (0%)      0 (0%)</span><br><span class="line">  hugepages-2Mi      0 (0%)      0 (0%)</span><br><span class="line">Events:</span><br><span class="line">  Type    Reason                   Age                From     Message</span><br><span class="line">  ----    ------                   ----               ----     -------</span><br><span class="line">  Normal  NodeHasSufficientMemory  47m (x6 over 47m)  kubelet  Node lucid-gigs-2.localdomain status is now: NodeHasSufficientMemory</span><br><span class="line">  Normal  NodeHasNoDiskPressure    47m (x6 over 47m)  kubelet  Node lucid-gigs-2.localdomain status is now: NodeHasNoDiskPressure</span><br><span class="line">  Normal  NodeHasSufficientPID     47m (x6 over 47m)  kubelet  Node lucid-gigs-2.localdomain status is now: NodeHasSufficientPID</span><br><span class="line">  Normal  Starting                 46m                kubelet  Starting kubelet.</span><br><span class="line">  Normal  NodeHasSufficientMemory  46m                kubelet  Node lucid-gigs-2.localdomain status is now: NodeHasSufficientMemory</span><br><span class="line">  Normal  NodeHasNoDiskPressure    46m                kubelet  Node lucid-gigs-2.localdomain status is now: NodeHasNoDiskPressure</span><br><span class="line">  Normal  NodeHasSufficientPID     46m                kubelet  Node lucid-gigs-2.localdomain status is now: NodeHasSufficientPID</span><br><span class="line">  Normal  NodeAllocatableEnforced  46m                kubelet  Updated Node Allocatable limit across pods</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°é™¤äº†èŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¿˜æœ‰çŠ¶æ€å’Œäº‹ä»¶ï¼Œå®ƒä»¬éƒ½æœ‰<code>Reason</code>è¿™ä¸ªå­—æ®µï¼Œé€è¿‡å®ƒï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“<code>MemoryPressure</code>,<code>DiskPressure</code>å’Œ<code>PIDPressure</code>éƒ½ä¸º<code>false</code>ï¼Œæ¯”è¾ƒåˆšåˆšæ­å»ºå¥½å„ç§èµ„æºéƒ½å¾ˆå……è£•ã€‚ä¹‹æ‰€ä»¥è¿™ä¸ªèŠ‚ç‚¹è¿˜æœªå‡†å¤‡å¥½æ˜¯å› ä¸ºï¼š<code>container runtime network not ready: NetworkReady=false reason:NetworkPluginNotReady message:docker: network plugin is not ready: cni config uninitialized</code>, æ²¡æœ‰å®‰è£…ç½‘ç»œæ’ä»¶ã€‚</p>
<h2 id="Install-Plugin"><a href="#Install-Plugin" class="headerlink" title="Install Plugin"></a>Install Plugin</h2><p>åˆ°è¿™é‡Œæˆ‘è¸©äº†æœ€å¤§çš„å‘ï¼Œä¸ºæ­¤æˆ‘åå¤é‡å¤ä¸Šé¢çš„æ­¥éª¤å‡ ä¸ªå°æ—¶ï¼æˆ‘ä½¿ç”¨äº†<code>kubectl apply -f &quot;https://cloud.weave.works/k8s/net?k8s-version=$(kubectl version | base64 | tr -d &#39;\n&#39;)&quot;</code>æ¥å®‰è£…<code>weave</code>æ’ä»¶ï¼Œä½†æ˜¯å°±æ˜¯æ­»æ´»ä¸æˆåŠŸğŸ‘¿ï¼åæ¥æˆ‘æ›´æ”¹äº†ç½‘æ¡¥çš„é…ç½®åæ‰ç®—æˆåŠŸï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">modprobe br_netfilter</span><br><span class="line">sysctl -p</span><br><span class="line">sudo sysctl net.bridge.bridge-nf-call-iptables=1</span><br></pre></td></tr></table></figure>

<h2 id="Check-Pods"><a href="#Check-Pods" class="headerlink" title="Check Pods"></a>Check Pods</h2><p>ä½¿ç”¨å‘½ä»¤<code>kubectl get pods</code> æŸ¥çœ‹pods çŠ¶æ€ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â¯ kubectl get pods -n kube-system</span><br><span class="line">NAME                                               READY   STATUS             RESTARTS   AGE</span><br><span class="line">etcd-lucid-gigs-2.localdomain                      1/1     Running            0          63m</span><br><span class="line">kube-apiserver-lucid-gigs-2.localdomain            1/1     Running            0          63m</span><br><span class="line">kube-controller-manager-lucid-gigs-2.localdomain   0/1     CrashLoopBackOff   18         63m</span><br><span class="line">kube-scheduler-lucid-gigs-2.localdomain            1/1     Running            0          63m</span><br></pre></td></tr></table></figure>

<p>kube-systemæ˜¯Kubernetesé¡¹ç›®é¢„ç•™çš„ç³»ç»ŸPodçš„å·¥ä½œç©ºé—´ï¼ˆNamepsaceï¼Œæ³¨æ„å®ƒå¹¶ä¸æ˜¯Linux Namespaceï¼Œå®ƒåªæ˜¯Kubernetesåˆ’åˆ†ä¸åŒå·¥ä½œç©ºé—´çš„å•ä½ï¼‰ã€‚</p>
<h2 id="Taint-Toleration"><a href="#Taint-Toleration" class="headerlink" title="Taint/Toleration"></a>Taint/Toleration</h2><p>Kubernetesçš„Taint/Tolerationæœºåˆ¶ä½¿å¾—é»˜è®¤æƒ…å†µä¸‹MasterèŠ‚ç‚¹æ˜¯ä¸å…è®¸è¿è¡Œç”¨æˆ·Podâ€”â€”ä¸€æ—¦æŸä¸ªèŠ‚ç‚¹è¢«åŠ ä¸Šäº†ä¸€ä¸ªTaintï¼Œå³è¢«â€œæ‰“ä¸Šäº†æ±¡ç‚¹â€ï¼Œé‚£ä¹ˆæ‰€æœ‰Podå°±éƒ½ä¸èƒ½åœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œå› ä¸ºKubernetesçš„Podéƒ½æœ‰â€œæ´ç™–â€ã€‚é™¤éï¼Œæœ‰ä¸ªåˆ«çš„Podå£°æ˜è‡ªå·±èƒ½â€œå®¹å¿â€è¿™ä¸ªâ€œæ±¡ç‚¹â€ï¼Œå³å£°æ˜äº†Tolerationï¼Œå®ƒæ‰å¯ä»¥åœ¨è¿™ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‘½ä»¤<code>kubectl taint nodes mynode foo=bar:NoSchedule</code>æ‰“ä¸Šæ±¡ç‚¹ã€‚åœ¨é…ç½®podæ—¶åˆ™éœ€è¦ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">tolerations:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">&quot;foo&quot;</span></span><br><span class="line">    <span class="attr">operator:</span> <span class="string">&quot;Equal&quot;</span></span><br><span class="line">    <span class="attr">value:</span> <span class="string">&quot;bar&quot;</span></span><br><span class="line">    <span class="attr">effect:</span> <span class="string">&quot;NoSchedule&quot;</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­<code>NoSchedule</code>ï¼Œæ„å‘³ç€è¿™ä¸ªTaintåªä¼šåœ¨è°ƒåº¦æ–°Podæ—¶äº§ç”Ÿä½œç”¨ï¼Œè€Œä¸ä¼šå½±å“å·²ç»åœ¨èŠ‚ç‚¹ä¸Šè¿è¡Œçš„Podï¼Œå“ªæ€•å®ƒä»¬æ²¡æœ‰Tolerationã€‚è¿™ä¸ªPodèƒ½â€œå®¹å¿â€æ‰€æœ‰é”®å€¼å¯¹ä¸ºfoo=barçš„Taintï¼ˆ operator: â€œEqualâ€ï¼Œâ€œç­‰äºâ€æ“ä½œï¼‰ã€‚</p>
<p>å¯¹äºæˆ‘è¿™ä¸ªæ–°å»ºçš„èŠ‚ç‚¹ï¼Œå¯ä»¥å‘ç°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Taints:             node-role.kubernetes.io/master:NoSchedule</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œåªæœ‰é”®ï¼Œé‚£ä¹ˆé…ç½®podæ—¶éœ€è¦ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Pod</span><br><span class="line">...</span><br><span class="line">spec:</span><br><span class="line">  tolerations:</span><br><span class="line">  - key: &quot;foo&quot;</span><br><span class="line">    operator: &quot;Exists&quot;</span><br><span class="line">    effect: &quot;NoSchedule&quot;</span><br></pre></td></tr></table></figure>

<p>è€Œæˆ‘åªæƒ³è¦ä¸€ä¸ªå•èŠ‚ç‚¹çš„k8sï¼Œæ‰€ä»¥æˆ‘é€‰æ‹©åˆ æ‰è¿™ä¸ªtaintï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes --all node-role.kubernetes.io/master-</span><br></pre></td></tr></table></figure>

<p>åœ¨â€œ<code>node-role.kubernetes.io/master</code>â€è¿™ä¸ªé”®åé¢åŠ ä¸Šäº†ä¸€ä¸ªçŸ­æ¨ªçº¿â€œ-â€ï¼Œè¿™ä¸ªæ ¼å¼å°±æ„å‘³ç€ç§»é™¤æ‰€æœ‰ä»¥â€œ<code>node-role.kubernetes.io/master</code>â€ä¸ºé”®çš„Taintã€‚</p>
<h2 id="Deploy-Dashboard-plugin"><a href="#Deploy-Dashboard-plugin" class="headerlink" title="Deploy Dashboard plugin"></a>Deploy Dashboard plugin</h2><p>ä½¿ç”¨<code>kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.2.0/aio/deploy/recommended.yaml</code>éƒ¨ç½²<code>Dashboard</code>ã€‚</p>
<h2 id="Deploy-Rook-plugin"><a href="#Deploy-Rook-plugin" class="headerlink" title="Deploy Rook plugin"></a>Deploy Rook plugin</h2><blockquote>
<p>Rooké¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäºCephçš„Kuberneteså­˜å‚¨æ’ä»¶ï¼ˆå®ƒåæœŸä¹Ÿåœ¨åŠ å…¥å¯¹æ›´å¤šå­˜å‚¨å®ç°çš„æ”¯æŒï¼‰ã€‚ä¸è¿‡ï¼Œä¸åŒäºå¯¹Cephçš„ç®€å•å°è£…ï¼ŒRookåœ¨è‡ªå·±çš„å®ç°ä¸­åŠ å…¥äº†æ°´å¹³æ‰©å±•ã€è¿ç§»ã€ç¾éš¾å¤‡ä»½ã€ç›‘æ§ç­‰å¤§é‡çš„ä¼ä¸šçº§åŠŸèƒ½ï¼Œä½¿å¾—è¿™ä¸ªé¡¹ç›®å˜æˆäº†ä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§çº§åˆ«å¯ç”¨çš„å®¹å™¨å­˜å‚¨æ’ä»¶ã€‚</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git clone --single-branch --branch v1.3.11 https://github.com/rook/rook.git</span><br><span class="line">cd rook/cluster/examples/kubernetes/ceph</span><br><span class="line">kubectl create -f common.yaml</span><br><span class="line">kubectl create -f operator.yaml</span><br><span class="line">kubectl create -f cluster.yaml</span><br></pre></td></tr></table></figure>

<p>åˆ°è¿™é‡Œæˆ‘åˆé‡åˆ°é”™è¯¯äº†ï¼š<code>no matches for kind &quot;CephCluster&quot; in version &quot;ceph.rook.io/v1&quot;</code>,åŸå› æ˜¯æ²¡æœ‰å…ˆè£…ä¸Š<code>common</code>ï¼Œæ²¡åŠæ³•åªèƒ½åˆ äº†é‡è£…ã€‚</p>
<h2 id="First-Pod-ğŸ˜¹"><a href="#First-Pod-ğŸ˜¹" class="headerlink" title="First Pod ğŸ˜¹"></a>First Pod ğŸ˜¹</h2><p>è¿™é‡Œæˆ‘ç”¨äº†å®˜æ–¹çš„ä¾‹å­ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-deployment</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">editor:</span> <span class="string">vscode</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è®°å½•ä¸€ä¸‹åè¯ï¼š</p>
<ul>
<li><p><code>yaml</code>ï¼šå¯¹åº”åˆ°Kubernetesä¸­ï¼Œå°±æ˜¯ä¸€ä¸ªAPI Object</p>
</li>
<li><p><code>kind</code>ï¼šè¿™ä¸ªAPIå¯¹è±¡çš„ç±»å‹ï¼ˆTypeï¼‰</p>
</li>
<li><p><code>Deployment</code>ï¼šä¸€ä¸ªå®šä¹‰å¤šå‰¯æœ¬åº”ç”¨ï¼ˆå³å¤šä¸ªå‰¯æœ¬Podï¼‰çš„å¯¹è±¡ï¼Œåœ¨Podå®šä¹‰å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯¹æ¯ä¸ªå‰¯æœ¬è¿›è¡Œæ»šåŠ¨æ›´æ–°ï¼ˆRolling Updateï¼‰</p>
</li>
<li><p><code>sepc.replicas</code>ï¼šPodå‰¯æœ¬ä¸ªæ•°</p>
</li>
<li><p><code>spec.template</code>ï¼šæè¿°äº†åˆ›å»º Pod çš„ç»†èŠ‚</p>
</li>
<li><p><code>metadata</code>ï¼šAPIå¯¹è±¡çš„â€œæ ‡è¯†â€ï¼Œå³å…ƒæ•°æ®ï¼Œå®ƒä¹Ÿæ˜¯æˆ‘ä»¬ä»Kubernetesé‡Œæ‰¾åˆ°è¿™ä¸ªå¯¹è±¡çš„ä¸»è¦ä¾æ®ã€‚è¿™å…¶ä¸­æœ€ä¸»è¦ä½¿ç”¨åˆ°çš„å­—æ®µæ˜¯<code>labels</code></p>
</li>
<li><p><code>labels</code>ï¼šä¸€ç»„key-valueæ ¼å¼çš„æ ‡ç­¾</p>
</li>
<li><p><code>spec.selector.matchLabels</code>ï¼šé¡¾åæ€ä¹‰ï¼Œä»Kubernetesä¸­åˆ©ç”¨<code>label</code>è¿‡æ»¤å‡ºå®ƒæ‰€å…³å¿ƒçš„è¢«æ§åˆ¶å¯¹è±¡ã€‚Deploymentä¼šæŠŠæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ã€æºå¸¦â€œapp: nginxâ€æ ‡ç­¾çš„Podè¯†åˆ«ä¸ºè¢«ç®¡ç†çš„å¯¹è±¡ï¼Œå¹¶ç¡®ä¿è¿™äº›Podçš„æ€»æ•°ä¸¥æ ¼ç­‰äºä¸¤ä¸ªã€‚</p>
</li>
<li><p><code>annotations</code>ï¼šä¸“é—¨ç”¨æ¥æºå¸¦key-valueæ ¼å¼çš„å†…éƒ¨ä¿¡æ¯ã€‚æ‰€è°“å†…éƒ¨ä¿¡æ¯ï¼ŒæŒ‡çš„æ˜¯å¯¹è¿™äº›ä¿¡æ¯æ„Ÿå…´è¶£çš„ï¼Œæ˜¯Kubernetesç»„ä»¶æœ¬èº«ï¼Œè€Œä¸æ˜¯ç”¨æˆ·</p>
</li>
</ul>
<p>åˆ©ç”¨å‘½ä»¤<code>kubectl create -f nginx-deployment.yaml</code>å³å¯åˆ›å»ºä¸¤ä¸ªpodsï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â¯ kubectl get pods -l app=nginx</span><br><span class="line">NAME                                READY   STATUS    RESTARTS   AGE</span><br><span class="line">nginx-deployment-59766c6d77-cn2tj   1/1     Running   0          13m</span><br><span class="line">nginx-deployment-59766c6d77-xmkr4   1/1     Running   0          13m</span><br></pre></td></tr></table></figure>

<h2 id="Describe-pod"><a href="#Describe-pod" class="headerlink" title="Describe pod"></a>Describe pod</h2><p>ä½¿ç”¨<code>kubectl describe pod nginx-deployment-59766c6d77-cn2tj</code>å¯ä»¥æŸ¥çœ‹ pod è¯¦ç»†ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">Name:         nginx-deployment-59766c6d77-cn2tj</span><br><span class="line">Namespace:    default</span><br><span class="line">Priority:     0</span><br><span class="line">Node:         lucid-gigs-2.localdomain/23.105.209.66</span><br><span class="line">Start Time:   Wed, 23 Jun 2021 07:00:45 -0400</span><br><span class="line">Labels:       app=nginx</span><br><span class="line">              editor=vscode</span><br><span class="line">              pod-template-hash=59766c6d77</span><br><span class="line">Annotations:  &lt;none&gt;</span><br><span class="line">Status:       Running</span><br><span class="line">IP:           10.32.0.9</span><br><span class="line">IPs:</span><br><span class="line">  IP:           10.32.0.9</span><br><span class="line">Controlled By:  ReplicaSet/nginx-deployment-59766c6d77</span><br><span class="line">Containers:</span><br><span class="line">  nginx:</span><br><span class="line">    Container ID:   docker://aafc006f5b0c17f0f5dc38284783c2615c3fb9e07687ec40bdcc4dce10bc88d5</span><br><span class="line">    Image:          nginx:latest</span><br><span class="line">    Image ID:       docker-pullable://nginx@sha256:47ae43cdfc7064d28800bc42e79a429540c7c80168e8c8952778c0d5af1c09db</span><br><span class="line">    Port:           80/TCP</span><br><span class="line">    Host Port:      0/TCP</span><br><span class="line">    State:          Running</span><br><span class="line">      Started:      Wed, 23 Jun 2021 07:01:32 -0400</span><br><span class="line">    Ready:          True</span><br><span class="line">    Restart Count:  0</span><br><span class="line">    Environment:    &lt;none&gt;</span><br><span class="line">    Mounts:</span><br><span class="line">      /var/run/secrets/kubernetes.io/serviceaccount from kube-api-access-gmckr (ro)</span><br><span class="line">Conditions:</span><br><span class="line">  Type              Status</span><br><span class="line">  Initialized       True </span><br><span class="line">  Ready             True </span><br><span class="line">  ContainersReady   True </span><br><span class="line">  PodScheduled      True </span><br><span class="line">Volumes:</span><br><span class="line">  kube-api-access-gmckr:</span><br><span class="line">    Type:                    Projected (a volume that contains injected data from multiple sources)</span><br><span class="line">    TokenExpirationSeconds:  3607</span><br><span class="line">    ConfigMapName:           kube-root-ca.crt</span><br><span class="line">    ConfigMapOptional:       &lt;nil&gt;</span><br><span class="line">    DownwardAPI:             true</span><br><span class="line">QoS Class:                   BestEffort</span><br><span class="line">Node-Selectors:              &lt;none&gt;</span><br><span class="line">Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists for 300s</span><br><span class="line">                             node.kubernetes.io/unreachable:NoExecute op=Exists for 300s</span><br><span class="line">Events:</span><br><span class="line">  Type    Reason     Age   From               Message</span><br><span class="line">  ----    ------     ----  ----               -------</span><br><span class="line">  Normal  Scheduled  14m   default-scheduler  Successfully assigned default/nginx-deployment-59766c6d77-cn2tj to lucid-gigs-2.localdomain</span><br><span class="line">  Normal  Pulling    14m   kubelet            Pulling image &quot;nginx:latest&quot;</span><br><span class="line">  Normal  Pulled     13m   kubelet            Successfully pulled image &quot;nginx:latest&quot; in 31.917109223s</span><br><span class="line">  Normal  Created    13m   kubelet            Created container nginx</span><br><span class="line">  Normal  Started    13m   kubelet            Started container nginx</span><br></pre></td></tr></table></figure>

<p>ä»<code>Events</code>ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå®ƒè¢«è°ƒåº¦å™¨åˆ†é…åˆ°äº†èŠ‚ç‚¹<code>lucid-gigs-2.localdomain</code>ï¼Œç„¶åæ‹‰å–äº†é•œåƒï¼Œåˆ›å»ºå¹¶å¯åŠ¨äº†å®¹å™¨ã€‚</p>
<h2 id="å£°æ˜å¼API"><a href="#å£°æ˜å¼API" class="headerlink" title="å£°æ˜å¼API"></a>å£°æ˜å¼API</h2><p>å¦‚æœæˆ‘ä»¬è¦æ›´æ”¹nginxçš„ç‰ˆæœ¬æˆ–è€…ä¿®æ”¹é…ç½®ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹<code>nginx-deployment.yaml</code>ï¼Œç„¶åæ‰§è¡Œ<code>kubectl apply -f nginx-deployment.yaml</code>ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæˆ‘ä»¬ä¸å¿…å…³å¿ƒå½“å‰çš„æ“ä½œæ˜¯åˆ›å»ºï¼Œè¿˜æ˜¯æ›´æ–°ï¼Œæ‰§è¡Œçš„å‘½ä»¤å§‹ç»ˆæ˜¯<code>kubectl apply</code>ï¼Œè€Œ k8s åˆ™ä¼šæ ¹æ®YAMLæ–‡ä»¶çš„å†…å®¹å˜åŒ–ï¼Œè‡ªåŠ¨è¿›è¡Œå…·ä½“çš„å¤„ç†ã€‚è€Œè¿™ä¸ªæµç¨‹çš„å¥½å¤„æ˜¯ï¼Œå®ƒæœ‰åŠ©äºå¸®åŠ©å¼€å‘å’Œè¿ç»´äººå‘˜ï¼Œå›´ç»•ç€å¯ä»¥ç‰ˆæœ¬åŒ–ç®¡ç†çš„YAMLæ–‡ä»¶ï¼Œè€Œä¸æ˜¯â€œè¡Œè¸ªä¸å®šâ€çš„å‘½ä»¤è¡Œè¿›è¡Œåä½œï¼Œä»è€Œå¤§å¤§é™ä½å¼€å‘äººå‘˜å’Œè¿ç»´äººå‘˜ä¹‹é—´çš„æ²Ÿé€šæˆæœ¬ã€‚</p>
<p>ä¿®æ”¹é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-deployment</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">editor:</span> <span class="string">vscode</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">&quot;/usr/share/nginx/html&quot;</span></span><br><span class="line">              <span class="attr">name:</span> <span class="string">nginx-vol</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-vol</span></span><br><span class="line">          <span class="attr">emptyDir:</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œè¿è¡Œ<code>kubectl create -f nginx-deployment.yaml</code>ï¼Œå°±å¯ä»¥æ›´æ–°äº†ã€‚</p>
<p>ä¸å¾—ä¸è¯´ï¼Œåˆ°æœ€ååªè¦ä¿®æ”¹<code>yaml</code>æ–‡ä»¶å°±å¯ä»¥æ›´æ–°é…ç½®æ˜¯æˆ‘ä»å‰æƒ³éƒ½ä¸æ•¢æƒ³çš„ï¼Œå°½ç®¡é‡åˆ°äº†å‘å¡äº†å‡ ä¸ªå°æ—¶ï¼Œä½†æ˜¯åˆ°æœ€åä½“ä¼šåˆ°å®ƒçš„å¼ºå¤§ï¼Œå¤ªå€¼äº†ï¼</p>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>Author: <a href="https://konoakira.com">Akira</a>
            <p>Post Link: <a href="https://konoakira.com/2020/12/23/k8s-best-practice/">https://konoakira.com/2020/12/23/k8s-best-practice/</a>
            <p>Publish Date: <a href="https://konoakira.com/2020/12/23/k8s-best-practice/">December 23rd 2020, 9:22:04 am</a>
            <p>Update Date: <a href="https://konoakira.com/2020/12/23/k8s-best-practice/">June 24th 2021, 10:43:00 am</a>
            <p>Copyright Notice: All articles in this blog are licensed under <a rel="license noopener" target="_blank" href="http://creativecommons.org/licenses/by-nc/4.0/"> unless stating additionally.</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2021/01/11/median-of-two-sorted-arrays/" title= "median of two sorted arrays">
                    <div class="nextTitle">median of two sorted arrays</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2020/12/09/minimum-path-sum-from-top-to-bottom/" title= "ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ">
                    <div class="prevTitle">ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ</div>
                </a>
            
        </li>
    </ul>
    <!-- è¯„è®ºæ’ä»¶ -->
    <!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->

<!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
    
    
    <!-- gitalkè¯„è®º -->

    <div id="comment-container"></div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.0/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.0/dist/gitalk.min.js"></script>
    <script>
        var gitalk = new Gitalk({
            clientID: 'c2bb6ecdc360d1417817',
            clientSecret: '3081aae8990bcbf19f97f3e13ce016eaa434b878',
            id: '1608686524000',
            repo: 'konoakira.github.io',
            owner: 'konoakira',
            admin: "konoakira",
            createIssueManually: true,
            distractionFreeMode: false
        })
        gitalk.render('comment-container')
    </script>
    
    <!-- utterancè¯„è®º -->

    <!-- partial('_partial/comment/changyan') -->
    <!--PCç‰ˆ-->


    
    

    <!-- è¯„è®º -->

    <!-- idea from: https://hexo.fluid-dev.com/posts/hexo-injector/#%E6%96%87%E7%AB%A0%E6%97%B6%E6%95%88%E6%80%A7%E6%8F%90%E7%A4%BA -->
    
</main>

            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:konoakira@outlook.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/konoakira" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- ä¸è’œå­  -->
    
		<!-- mermaid -->
		
			<script src='https://unpkg.com/mermaid@8.10.2/dist/mermaid.min.js'></script>
			<script>
				if (window.mermaid) {
					var options = JSON.parse('{"flowchart":{"curve":"basis"}}');
					mermaid.initialize(options);
				}
			</script>
				
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-Docker-amp-Kubeadm"><span class="toc-number">1.</span> <span class="toc-text">Install Docker &amp; Kubeadm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#First-k8s-Cluster-Node"><span class="toc-number">2.</span> <span class="toc-text">First k8s Cluster Node</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Check-Node"><span class="toc-number">3.</span> <span class="toc-text">Check Node</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Install-Plugin"><span class="toc-number">4.</span> <span class="toc-text">Install Plugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Check-Pods"><span class="toc-number">5.</span> <span class="toc-text">Check Pods</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Taint-Toleration"><span class="toc-number">6.</span> <span class="toc-text">Taint&#x2F;Toleration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Deploy-Dashboard-plugin"><span class="toc-number">7.</span> <span class="toc-text">Deploy Dashboard plugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Deploy-Rook-plugin"><span class="toc-number">8.</span> <span class="toc-text">Deploy Rook plugin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#First-Pod-%F0%9F%98%B9"><span class="toc-number">9.</span> <span class="toc-text">First Pod ğŸ˜¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Describe-pod"><span class="toc-number">10.</span> <span class="toc-text">Describe pod</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A3%B0%E6%98%8E%E5%BC%8FAPI"><span class="toc-number">11.</span> <span class="toc-text">å£°æ˜å¼API</span></a></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- åœ¨ejsä¸­å°†archiveæŒ‰ç…§æ—¶é—´æ’åº -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 24
        </div>
        <!-- search  -->
        
            <div class="site-search popup-trigger">
                <span class="iconfont-archer search-icon">&#xe627;</span>
            </div>
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2021 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/29</span><a class="archive-post-title" href= "/2021/06/29/alternate-print/" >äº¤æ›¿æ‰“å°</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/24</span><a class="archive-post-title" href= "/2021/06/24/k8s-Controllers/" >k8s æ§åˆ¶å™¨æ¢ç§˜</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/19</span><a class="archive-post-title" href= "/2021/06/19/java-advanced-data-type/" >Java æ•°æ®ç±»å‹è¿›é˜¶</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/16</span><a class="archive-post-title" href= "/2021/06/16/egg-stone-ballon/" >é¸¡è›‹ï¼ŒçŸ³å¤´ä¸æ°”çƒ</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/13</span><a class="archive-post-title" href= "/2021/06/13/backpack-problems/" >èƒŒåŒ…é—®é¢˜</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/10</span><a class="archive-post-title" href= "/2021/06/10/best-time-to-buy-sell-stock/" >Best Time to Buy & Sell Stock</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/07</span><a class="archive-post-title" href= "/2021/06/07/docker-review-2/" >Docker æ€»ç»“äºŒ overlay2 ä¸ é•œåƒ</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/06</span><a class="archive-post-title" href= "/2021/06/06/docker-review-1/" >Docker æ€»ç»“ä¸€ éš”ç¦»ä¸é™åˆ¶</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/06</span><a class="archive-post-title" href= "/2021/06/06/fail-fast-&-fail-safe-iterator/" >Fail Fast & Fail Safe è¿­ä»£å™¨</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/04</span><a class="archive-post-title" href= "/2021/06/04/java-basics-collections/" >Java é›†åˆç±»æ€»ç»“</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/23</span><a class="archive-post-title" href= "/2021/03/23/k8s-container-network/" >k8s å®¹å™¨ç½‘ç»œ</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href= "/2021/03/08/n-queens-my-template/" >n çš‡åï¼Œæˆ‘çš„å¥—è·¯</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/02</span><a class="archive-post-title" href= "/2021/03/02/java-basics-map/" >Java map æ€»ç»“</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/15</span><a class="archive-post-title" href= "/2021/02/15/java-basics-oop/" >Java é¢å‘å¯¹è±¡æ€»ç»“</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/14</span><a class="archive-post-title" href= "/2021/02/14/java-basics-data-type/" >Java æ•°æ®ç±»å‹</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/21</span><a class="archive-post-title" href= "/2021/01/21/deterministic-finite-automaton/" >ç¡®å®šæœ‰é™çŠ¶æ€è‡ªåŠ¨æœº</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/11</span><a class="archive-post-title" href= "/2021/01/11/median-of-two-sorted-arrays/" >median of two sorted arrays</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2020 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/23</span><a class="archive-post-title" href= "/2020/12/23/k8s-best-practice/" >k8s æœ€ä½³å®è·µï¼ˆFor me ğŸ™‚ï¼‰</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/09</span><a class="archive-post-title" href= "/2020/12/09/minimum-path-sum-from-top-to-bottom/" >ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/25</span><a class="archive-post-title" href= "/2020/11/25/slice-and-backtrack/" >åˆ‡ç‰‡å’Œå›æº¯æ³•</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/14</span><a class="archive-post-title" href= "/2020/09/14/golang-basics-data-structure/" >golang basics - data structure</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/26</span><a class="archive-post-title" href= "/2020/06/26/bio-nio-aio-netty/" >bio,nio,aio&netty</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/07</span><a class="archive-post-title" href= "/2020/05/07/Why-I-Implement-Binary-Search-Like-This/" >ä¸ºä»€ä¹ˆæˆ‘è¦è¿™ä¹ˆå†™äºŒåˆ†æŸ¥æ‰¾?</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/29</span><a class="archive-post-title" href= "/2020/03/29/spring-cloud-alibaba-tutorial-1/" >spring cloud alibaba å…¨å®¶æ¡¶é£Ÿç”¨è®°å½•-1ï¼šdubbo</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="netty"><span class="iconfont-archer">&#xe606;</span>netty</span>
    
        <span class="sidebar-tag-name" data-tags="binary search"><span class="iconfont-archer">&#xe606;</span>binary search</span>
    
        <span class="sidebar-tag-name" data-tags="dynamic programming"><span class="iconfont-archer">&#xe606;</span>dynamic programming</span>
    
        <span class="sidebar-tag-name" data-tags="docker"><span class="iconfont-archer">&#xe606;</span>docker</span>
    
        <span class="sidebar-tag-name" data-tags="deterministic finite automaton"><span class="iconfont-archer">&#xe606;</span>deterministic finite automaton</span>
    
        <span class="sidebar-tag-name" data-tags="basic"><span class="iconfont-archer">&#xe606;</span>basic</span>
    
        <span class="sidebar-tag-name" data-tags="advanced"><span class="iconfont-archer">&#xe606;</span>advanced</span>
    
        <span class="sidebar-tag-name" data-tags="kubernetes"><span class="iconfont-archer">&#xe606;</span>kubernetes</span>
    
        <span class="sidebar-tag-name" data-tags="k8s"><span class="iconfont-archer">&#xe606;</span>k8s</span>
    
        <span class="sidebar-tag-name" data-tags="backtrack"><span class="iconfont-archer">&#xe606;</span>backtrack</span>
    
        <span class="sidebar-tag-name" data-tags="slice"><span class="iconfont-archer">&#xe606;</span>slice</span>
    
        <span class="sidebar-tag-name" data-tags="dubbo"><span class="iconfont-archer">&#xe606;</span>dubbo</span>
    
        <span class="sidebar-tag-name" data-tags="concurrency"><span class="iconfont-archer">&#xe606;</span>concurrency</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    ç¼ºå¤±æ¨¡å—ã€‚<br/>
    1ã€è¯·ç¡®ä¿nodeç‰ˆæœ¬å¤§äº6.2<br/>
    2ã€åœ¨åšå®¢æ ¹ç›®å½•ï¼ˆæ³¨æ„ä¸æ˜¯archeræ ¹ç›®å½•ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3ã€åœ¨æ ¹ç›®å½•_config.ymlé‡Œæ·»åŠ é…ç½®ï¼š
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
        <span class="sidebar-category-name" data-categories="Java"><span class="iconfont-archer">&#xe60a;</span>Java</span>
    
        <span class="sidebar-category-name" data-categories="algorithms"><span class="iconfont-archer">&#xe60a;</span>algorithms</span>
    
        <span class="sidebar-category-name" data-categories="leetocode"><span class="iconfont-archer">&#xe60a;</span>leetocode</span>
    
        <span class="sidebar-category-name" data-categories="leetcode"><span class="iconfont-archer">&#xe60a;</span>leetcode</span>
    
        <span class="sidebar-category-name" data-categories="Cloud-Native"><span class="iconfont-archer">&#xe60a;</span>Cloud-Native</span>
    
        <span class="sidebar-category-name" data-categories="golang"><span class="iconfont-archer">&#xe60a;</span>golang</span>
    
        <span class="sidebar-category-name" data-categories="Cloud-Native"><span class="iconfont-archer">&#xe60a;</span>Cloud-Native</span>
    
        <span class="sidebar-category-name" data-categories="microservices"><span class="iconfont-archer">&#xe60a;</span>microservices</span>
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "Akira"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
        <div class="site-search">
  <div class="algolia-popup popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="iconfont-archer">&#xe609;</i>
    </span>
  </div>
</div>


        <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4.8.3/dist/instantsearch.production.min.js" integrity="sha256-LAGhRRdtVoD6RLo2qDQsU2mp+XVSciKRC8XPOBWmofM=" crossorigin="anonymous"></script>
        <script src="/scripts/search.js" defer></script>
    
    <!-- busuanzi  -->
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>


